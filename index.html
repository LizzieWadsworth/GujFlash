<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Gujarati Flashcards (1,000 words)</title>
  <meta name="description" content="Flashcards for learning 1,000 common Gujarati words with English meanings.">
  <style>
    :root{
      --bg:#0f172a;        /* slate-900 */
      --card:#111827;      /* gray-900 */
      --muted:#94a3b8;     /* slate-400 */
      --text:#e5e7eb;      /* gray-200 */
      --accent:#22d3ee;    /* cyan-400 */
      --accent-2:#a78bfa;  /* violet-400 */
      --btn:#1f2937;       /* gray-800 */
      --btn-hover:#374151; /* gray-700 */
      --ring:#334155;      /* slate-700 */
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif;
      background: radial-gradient(1200px 800px at 10% -10%, rgba(167,139,250,.12), transparent 60%),
                  radial-gradient(1000px 700px at 120% 10%, rgba(34,211,238,.12), transparent 60%),
                  var(--bg);
      color:var(--text);
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      padding:24px;
      gap:16px;
    }
    header{
      text-align:center;
    }
    header h1{
      margin:0 0 6px 0;
      font-weight:800;
      letter-spacing:.3px;
    }
    header p{
      margin:0;
      color:var(--muted);
      font-size:0.95rem;
    }

    .controls{
      width:min(960px, 95vw);
      display:grid;
      grid-template-columns: 1fr auto auto auto;
      gap:8px;
      align-items:center;
    }
    .controls input[type="search"]{
      width:100%;
      padding:12px 14px;
      border:1px solid var(--ring);
      border-radius:12px;
      background:rgba(255,255,255,0.04);
      color:var(--text);
      outline:none;
    }
    .controls button, .controls select{
      padding:10px 14px;
      border:1px solid var(--ring);
      border-radius:12px;
      background:var(--btn);
      color:var(--text);
      cursor:pointer;
    }
    .controls button:hover{ background:var(--btn-hover); }
    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:8px 12px;
      border:1px solid var(--ring);
      border-radius:999px;
      color:var(--muted);
      font-size:.9rem;
    }

    .card{
      width:min(960px, 95vw);
      min-height:280px;
      background:linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,.02)) , var(--card);
      border:1px solid var(--ring);
      border-radius:24px;
      padding:28px;
      position:relative;
      box-shadow: 0 30px 50px rgba(0,0,0,.35);
      display:flex;
      flex-direction:column;
      justify-content:center;
      align-items:center;
      text-align:center;
      user-select:none;
    }
    .gujarati{
      font-size: clamp(2rem, 7vw, 4rem);
      line-height:1.2;
      margin:0 0 10px 0;
      font-weight:700;
    }
    .english{
      font-size: clamp(1.1rem, 3.2vw, 1.6rem);
      color:var(--muted);
      margin:0;
    }

    .nav{
      display:flex;
      gap:10px;
      margin-top:18px;
    }
    .nav button{
      padding:12px 16px;
      border:1px solid var(--ring);
      border-radius:12px;
      background:var(--btn);
      color:var(--text);
      cursor:pointer;
      min-width:120px;
      font-weight:600;
    }
    .nav button:hover{ background:var(--btn-hover); }
    .progress{
      width:min(960px, 95vw);
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:8px;
    }
    progress{
      width:100%;
      height:10px;
      appearance:none;
      -webkit-appearance:none;
    }
    progress::-webkit-progress-bar{ background:#111827; border-radius:999px; }
    progress::-webkit-progress-value{ background:linear-gradient(90deg,var(--accent),var(--accent-2)); border-radius:999px; }
    .kbd{
      font-family: ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;
      border:1px solid var(--ring);
      border-bottom-width:3px;
      border-radius:8px;
      padding:2px 6px;
      background:#0b1220;
      color:var(--muted);
      font-size:.85rem;
    }
    footer{
      color:var(--muted);
      font-size:.85rem;
      text-align:center;
      margin-top:12px;
    }
  </style>
</head>
<body>
  <header>
    <h1>Gujarati Flashcards</h1>
    <p>1,000 common words — Gujarati → English</p>
  </header>

  <div class="controls" role="region" aria-label="Controls">
    <input id="search" type="search" placeholder="Search English or Gujarati…" aria-label="Search words">
    <button id="shuffle" title="Shuffle deck">Shuffle</button>
    <select id="revealMode" title="Reveal mode">
      <option value="both" selected>Show both</option>
      <option value="gu">Gujarati only</option>
      <option value="en">English only</option>
    </select>
    <span id="counter" class="pill" aria-live="polite">0 / 0</span>
  </div>

  <main class="card" tabindex="0" aria-live="polite">
    <div id="gujarati" class="gujarati">—</div>
    <div id="english" class="english">—</div>

    <div class="nav">
      <button id="prev" aria-label="Previous (←)">← Previous</button>
      <button id="next" aria-label="Next (→)">Next →</button>
    </div>
  </main>

  <div class="progress">
    <progress id="bar" max="100" value="0"></progress>
    <span class="pill"><span id="percent">0%</span></span>
  </div>

  <footer>
    Tip: Use <span class="kbd">←</span> and <span class="kbd">→</span> to navigate. Press <span class="kbd">S</span> to shuffle.
  </footer>

  <!-- App logic: expects flashcards.js that loads data-1000.json -->
  <script>
    // Helpers layered atop your flashcards.js
    let deck = [];
    let filtered = [];
    let idx = 0;
    let reveal = "both";

    // Patch: if flashcards.js defines global functions/vars:
    // - loadFlashcards() will set window.flashcards
    // - currentIndex will be managed there; we keep our own view state too.
    function syncFromGlobal(){
      if (!Array.isArray(window.flashcards) || window.flashcards.length === 0) return;
      deck = window.flashcards.slice();
      filtered = deck.slice();
      idx = (window.currentIndex || 0) % filtered.length;
      updateUI();
    }

    function updateUI(){
      const card = filtered[idx] || { g: "—", e: "—" };
      const g = document.getElementById("gujarati");
      const e = document.getElementById("english");
      g.textContent = (reveal === "en") ? "•••" : card.g;
      e.textContent = (reveal === "gu") ? "•••" : card.e;

      const counter = document.getElementById("counter");
      counter.textContent = (filtered.length ? (idx+1) : 0) + " / " + filtered.length;

      const percent = filtered.length ? Math.round(((idx+1) / filtered.length) * 100) : 0;
      document.getElementById("bar").value = percent;
      document.getElementById("percent").textContent = percent + "%";
    }

    function go(n){
      if (!filtered.length) return;
      idx = ( (idx + n) % filtered.length + filtered.length ) % filtered.length;
      updateUI();
    }

    function shuffle(){
      for (let i = filtered.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [filtered[i], filtered[j]] = [filtered[j], filtered[i]];
      }
      idx = 0;
      updateUI();
    }

    function search(q){
      const s = q.trim().toLowerCase();
      if (!s){
        filtered = deck.slice();
      } else {
        filtered = deck.filter(d =>
          (d.g && String(d.g).toLowerCase().includes(s)) ||
          (d.e && String(d.e).toLowerCase().includes(s))
        );
      }
      idx = 0;
      updateUI();
    }

    document.addEventListener("DOMContentLoaded", () => {
      // Wait a tick for flashcards.js to load its data
      setTimeout(syncFromGlobal, 50);

      document.getElementById("prev").addEventListener("click", () => go(-1));
      document.getElementById("next").addEventListener("click", () => go(1));
      document.getElementById("shuffle").addEventListener("click", shuffle);
      document.getElementById("search").addEventListener("input", (e)=> search(e.target.value));
      document.getElementById("revealMode").addEventListener("change", (e)=>{
        reveal = e.target.value;
        updateUI();
      });

      // Keyboard shortcuts: arrows for nav, 's' for shuffle
      window.addEventListener("keydown", (e)=>{
        if (e.key === "ArrowLeft"){ e.preventDefault(); go(-1); }
        else if (e.key === "ArrowRight"){ e.preventDefault(); go(1); }
        else if (e.key.toLowerCase() === "s"){ shuffle(); }
      });
    });
  </script>
  <script src="flashcards.js"></script>
</body>
</html>
